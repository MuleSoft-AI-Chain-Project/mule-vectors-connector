<?xml version="1.0" encoding="UTF-8" standalone="no"?><mule xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:ms-vectors="http://www.mulesoft.org/schema/mule/ms-vectors" xmlns:munit="http://www.mulesoft.org/schema/mule/munit" xmlns:munit-tools="http://www.mulesoft.org/schema/mule/munit-tools" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="   http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd   http://www.mulesoft.org/schema/mule/munit http://www.mulesoft.org/schema/mule/munit/current/mule-munit.xsd   http://www.mulesoft.org/schema/mule/munit-tools  http://www.mulesoft.org/schema/mule/munit-tools/current/mule-munit-tools.xsd http://www.mulesoft.org/schema/mule/ms-vectors http://www.mulesoft.org/schema/mule/ms-vectors/current/mule-ms-vectors.xsd">
	<munit:config minMuleVersion="4.9.4" name="test-store-operations.xml">
		<munit:parameterizations >
			<munit:parameterization name="config-vector-opensearch" >
				<munit:parameters >
					<munit:parameter propertyName="config" value="storeOpenSearchConfig" />
					<munit:parameter propertyName="storeName" value="munit" />
					<munit:parameter propertyName="minScore" value="0.1" />
					<munit:parameter propertyName="topK" value="5" />
				</munit:parameters>
			</munit:parameterization>
		</munit:parameterizations>
	</munit:config>
	<munit:before-test name="test-store-operationsBefore_Test" doc:id="3a65ff20-fdb5-481e-8ebf-df6ddc664b93" >
	</munit:before-test>
	<munit:test doc:id="25c072ca-50b7-4072-aefb-25924bbd0511" name="store-operations-add-to-store">
		<munit:execution>
			<flow-ref doc:id="ae8eb0e5-96c8-420e-8a7b-64d9c408c7f0" doc:name="store-operations-ADD-to-store-exec" name="store-operations-add-to-store-exec"/>
			<logger doc:id="a396a786-90c7-43ca-87df-40187ba7699f" doc:name="Log payload" level="INFO" message="#[payload]"/>
		</munit:execution>
		<munit:validation>
			<flow-ref doc:id="af61ece6-eb78-48fc-a539-cad8120997f7" doc:name="store-operations-validate-add-to-store" name="store-operations-validate-add-to-store"/>
		</munit:validation>
	</munit:test>
	<sub-flow doc:id="4bdfd585-1485-43ef-9578-aad82e2eb13a" name="store-operations-validate-add-to-store">
		<munit-tools:assert-that doc:id="818bd443-493c-4f33-a5e1-bde725de890b" doc:name="Assert that payload is not null" expression="#[payload]" is="#[MunitTools::notNullValue()]" message="Payload is null"/>
		<munit-tools:assert-that doc:id="26cecb96-c7b8-461c-9056-0894591611f9" doc:name="Assert that sourceId is not null" expression="#[payload.sourceId]" is="#[MunitTools::notNullValue()]" message="Payload is null"/>
		<munit-tools:assert-equals actual="#[payload.status]" doc:id="b72ace94-3695-4082-a982-23b8437aee86" doc:name="Assert status is updated" expected="updated" message="#[&quot;The returned status &quot; ++ payload.status ++ &quot; is not correct.&quot;]"/>
		<munit-tools:assert-equals actual="#[sizeOf(payload.embeddingIds)]" doc:id="b3e08701-ffa0-48ef-9709-e6381eeea1c0" doc:name="Assert has 4 embedding ids" expected="#[4]" message="The operation did not return 4 embedding ids."/>
	</sub-flow>
	<munit:test doc:id="e4aba12a-2d12-442c-a83e-dbd14102b8d3" name="store-operations-query-from-store">
		<munit:execution>
			<set-variable value="#[uuid()]" doc:name="munit_uuid" doc:id="a803cbc2-4ce0-46c0-8531-793472233eaa" variableName="munit_uuid" />
			<flow-ref doc:name="store-operations-REMOVE-all-from-store" doc:id="d6e113b5-19a4-4455-af63-5c920fa0eb2e" name="store-operations-remove-all-from-store" />
			<flow-ref doc:id="5562ba21-0539-4c53-bbe3-b90dc27b1767" doc:name="store-operations-ADD-to-store-exec" name="store-operations-add-to-store-exec"/>
			<flow-ref doc:id="8e3c98b7-e562-4fff-9f18-d8991fae2484" doc:name="store-operations-QUERY-store-exec" name="store-operations-query-store-exec"/>
			<logger doc:id="ec87dd9e-bbf5-483b-8a12-cf3633b97b50" doc:name="Log payload" level="INFO" message="#[payload]"/>
		</munit:execution>
		<munit:validation>
			<flow-ref doc:id="9543b85e-419b-4e62-92e5-df281920b86b" doc:name="store-operations-validate-query-from-store" name="store-operations-validate-query-from-store"/>
		</munit:validation>
	</munit:test>
	<sub-flow doc:id="f35cf72c-c8df-4dff-9f8c-c4c889f8f91d" name="store-operations-validate-query-from-store">
		<munit-tools:assert-that doc:name="Assert that payload is not null" doc:id="7aa068ae-b2ea-4f83-a515-cff2e8efd272" message="Payload is null" expression="#[payload]" is="#[MunitTools::notNullValue()]" />
		<munit-tools:assert-equals doc:name="Assert has 4 sources" doc:id="8fc841db-9f6f-4447-ab35-419d3ba048c2" actual="#[sizeOf(payload.sources)]" expected="#[4]" message="The operation did not return 4 embedding ids." />
	</sub-flow>
	<munit:test doc:id="729af2a6-d85a-46b9-9584-ee6104382803" name="store-operations-query-all-from-store">
		<munit:execution>
			<set-variable value="#[uuid()]" doc:name="munit_uuid" doc:id="ca7f7c95-190d-418a-b9fd-937776b4961a" variableName="munit_uuid" />
			<flow-ref doc:name="store-operations-REMOVE-all-from-store" doc:id="b8c38fa7-b472-43f1-8438-447e3284105f" name="store-operations-remove-all-from-store" />
			<flow-ref doc:id="1cc9b910-2bc8-415a-965c-322acbcdff64" doc:name="store-operations-ADD-to-store-exec" name="store-operations-add-to-store-exec"/>
			<flow-ref doc:id="7b27c052-2315-4751-a939-2d22a78edfb5" doc:name="store-operations-QUERY-all-store-exec" name="store-operations-query-all-from-store-exec"/>
			<logger doc:id="0014bca8-5133-4cb4-93f2-de613bd8354f" doc:name="Log payload" level="INFO" message="#[payload]"/>
		</munit:execution>
		<munit:validation>
			<flow-ref doc:id="65d949e4-ee32-4b62-9e3b-70dae36adbfb" doc:name="store-operations-validate-query-all-from-store" name="store-operations-validate-query-all-from-store"/>
		</munit:validation>
	</munit:test>
	<sub-flow doc:id="5fb6a98f-09cd-43bc-9009-b40260107195" name="store-operations-validate-query-all-from-store">
		<munit-tools:assert-that doc:name="Assert that payload is not null" doc:id="09c96239-50dd-4ef1-85c6-e096c58f0179" message="Payload is null" expression="#[payload]" is="#[MunitTools::notNullValue()]" />
		<munit-tools:assert-that doc:name="Assert that has &gt;= 4 sources." doc:id="f87f41f5-b177-45b7-8415-9e9c47058286" is="#[MunitTools::greaterThanOrEqualTo(4)]" expression="#[sizeOf(payload)]"/>
	</sub-flow>

</mule>